CREATE DATABASE "SUPERMERCADOSQ";

CREATE TABLE CLIENTE (
	ID_CLIENTE SERIAL PRIMARY KEY,
	NOME VARCHAR(50) NOT NULL,
	CPF VARCHAR(15)
);

CREATE TABLE ADMINISTRADOR (
	ID_ADMINISTRADOR SERIAL PRIMARY KEY,
	NOME VARCHAR(50) NOT NULL,
	CPF VARCHAR(15)
);

CREATE TABLE FORNECEDOR (
	ID_FORNECEDOR SERIAL PRIMARY KEY,
	NOME VARCHAR(50) NOT NULL,
	CPF VARCHAR(15)
);

CREATE TABLE USUARIO (
	ID_USUARIO SERIAL PRIMARY KEY,
	EMAIL VARCHAR(50) NOT NULL,
	SENHA VARCHAR(50),
	NIVEL VARCHAR(15)
	CONSTRAINT NIVEL CHECK(NIVEL IN ('CLIENTE', 'FORNECEDOR', 'ADMINISTRADOR'))
);

CREATE TABLE ENDERECO (
	ID_ENDERECO SERIAL PRIMARY KEY,
	LOGRADOURO VARCHAR(30) NOT NULL,
	NUMERO VARCHAR(5),
	BAIRRO VARCHAR(15),
	CIDADE VARCHAR(15),
	ESTADO VARCHAR(15),
	ID_FORNECEDOR INT,
	ID_ADMINISTRADOR INT,
	ID_CLIENTE INT,
	FOREIGN KEY (ID_FORNECEDOR) REFERENCES FORNECEDOR(ID_FORNECEDOR),
	FOREIGN KEY (ID_ADMINISTRADOR) REFERENCES ADMINISTRADOR(ID_ADMINISTRADOR),
	FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE)
);

CREATE TABLE TELEFONE(
	ID_TELEFONE SERIAL PRIMARY KEY,
	DDD CHAR(3) NOT NULL,
	NUMERO VARCHAR(10),
	ID_FORNECEDOR INT,
	ID_ADMINISTRADOR INT,
	ID_CLIENTE INT,
	FOREIGN KEY (ID_FORNECEDOR) REFERENCES FORNECEDOR(ID_FORNECEDOR),
	FOREIGN KEY (ID_ADMINISTRADOR) REFERENCES ADMINISTRADOR(ID_ADMINISTRADOR),
	FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE)
);

CREATE TABLE PRODUTO(
	ID_PRODUTO SERIAL PRIMARY KEY,
	NOME VARCHAR(50),
	INGREDIENTES TEXT,
	IMAGEM BYTEA,
	ID_FORNECEDOR INT,
	ID_ADMINISTRADOR INT,
	ID_CLIENTE INT,
	FOREIGN KEY (ID_FORNECEDOR) REFERENCES FORNECEDOR(ID_FORNECEDOR),
	FOREIGN KEY (ID_ADMINISTRADOR) REFERENCES ADMINISTRADOR(ID_ADMINISTRADOR),
	FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE)
);

CREATE TABLE COMENTARIO(
	ID_COMENTARIO SERIAL PRIMARY KEY,
	MENSAGEM TEXT,
	INGREDIENTES TEXT,
	STATUS VARCHAR(10),
	CONSTRAINT STATUS CHECK(STATUS IN('ANALISE', 'APROVADO', 'REPROVADO')),
	ID_PRODUTO INT,
	FOREIGN KEY (ID_PRODUTO) REFERENCES PRODUTO(ID_PRODUTO)
);
