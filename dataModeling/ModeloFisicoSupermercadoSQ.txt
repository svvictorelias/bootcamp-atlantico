CREATE DATABASE "SUPERMERCADOSQ";

CREATE TABLE CLIENTE (
	IDCLIENTE SERIAL PRIMARY KEY,
	NOME VARCHAR(50) NOT NULL,
	CPF VARCHAR(15)
);

CREATE TABLE ADMINISTRADOR (
	IDADMINISTRADOR SERIAL PRIMARY KEY,
	NOME VARCHAR(50) NOT NULL,
	CPF VARCHAR(15)
);

CREATE TABLE FORNECEDOR (
	IDFORNECEDOR SERIAL PRIMARY KEY,
	NOME VARCHAR(50) NOT NULL,
	CPF VARCHAR(15)
);

CREATE TABLE USUARIO (
	IDUSUARIO SERIAL PRIMARY KEY,
	EMAIL VARCHAR(50) NOT NULL,
	SENHA VARCHAR(50),
	NIVEL VARCHAR(15)
	CONSTRAINT NIVEL CHECK(NIVEL IN ('CLIENTE', 'FORNECEDOR', 'ADMINISTRADOR'))
);

CREATE TABLE ENDERECO (
	IDENDERECO SERIAL PRIMARY KEY,
	LOGRADOURO VARCHAR(30) NOT NULL,
	NUMERO VARCHAR(5),
	BAIRRO VARCHAR(15),
	CIDADE VARCHAR(15),
	ESTADO VARCHAR(15),
	IDFORNECEDOR INT,
	IDADMINISTRADOR INT,
	IDCLIENTE INT,
	FOREIGN KEY (IDFORNECEDOR) REFERENCES FORNECEDOR(IDFORNECEDOR),
	FOREIGN KEY (IDADMINISTRADOR) REFERENCES ADMINISTRADOR(IDADMINISTRADOR),
	FOREIGN KEY (IDCLIENTE) REFERENCES CLIENTE(IDCLIENTE)
);

CREATE TABLE TELEFONE(
	IDTELEFONE SERIAL PRIMARY KEY,
	DDD CHAR(3) NOT NULL,
	NUMERO VARCHAR(10),
	IDFORNECEDOR INT,
	IDADMINISTRADOR INT,
	IDCLIENTE INT,
	FOREIGN KEY (IDFORNECEDOR) REFERENCES FORNECEDOR(IDFORNECEDOR),
	FOREIGN KEY (IDADMINISTRADOR) REFERENCES ADMINISTRADOR(IDADMINISTRADOR),
	FOREIGN KEY (IDCLIENTE) REFERENCES CLIENTE(IDCLIENTE)
);

CREATE TABLE PRODUTO(
	IDPRODUTO SERIAL PRIMARY KEY,
	NOME VARCHAR(50),
	INGREDIENTES TEXT,
	IMAGEM BYTEA,
	IDFORNECEDOR INT,
	IDADMINISTRADOR INT,
	IDCLIENTE INT,
	FOREIGN KEY (IDFORNECEDOR) REFERENCES FORNECEDOR(IDFORNECEDOR),
	FOREIGN KEY (IDADMINISTRADOR) REFERENCES ADMINISTRADOR(IDADMINISTRADOR),
	FOREIGN KEY (IDCLIENTE) REFERENCES CLIENTE(IDCLIENTE)
);

CREATE TABLE COMENTARIO(
	IDCOMENTARIO SERIAL PRIMARY KEY,
	MENSAGEM TEXT,
	INGREDIENTES TEXT,
	STATUS VARCHAR(10),
	CONSTRAINT STATUS CHECK(STATUS IN('ANALISE', 'APROVADO', 'REPROVADO')),
	IDPRODUTO INT,
	FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO(IDPRODUTO)
);
